<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Uploader</title>
</head>
<body>

<!-- START OF UPLOADER -->

<script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
<script type="text/javascript">
    var fileInput = null;
    var URL = 'https://api.onlinephotosubmission.com/api/passport-photos';

    function post(data) {
        $.ajax({
            type: 'POST',
            url: URL,
            dataType: 'json',
            contentType: 'application/json',
            data: JSON.stringify(data)
        });
    }

    function submit() {
        var data = {
            'email': $('#email').val(),
            'encodedImage': null
        }
        if (fileInput.files && fileInput.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                // $('#falseinput').attr('src', e.target.result);
                // $('#base').val(e.target.result);
                data.encodedImage = e.target.result;
                post(data);
            };
            reader.readAsDataURL(fileInput.files[0]);
            showStepThree();
        }
    }

    function showStepTwo() {
        $('.step-one').hide('slow');
        $('.step-two').show('slow');
        $('.step-three').hide('slow');
    }

    function showStepThree() {
        $('.step-one').hide('slow');
        $('.step-two').hide('slow');
        $('.step-three').show('slow');
    }

    function onFileChange(element) {
        fileInput = element;
        showStepTwo();
    }

</script>

<style>
    .step-container {
        width: 200px;
    }

    .step-two {
        display: none;
    }

    .step-three {
        display: none;
    }

    input {
        width: 100%;
    }
</style>
<h2 class="step-one">First, take your picture or select a photo from your device.</h2>
<div class="step-container step-one">
    <p><input id="fileinput" type="file" accept="image/gif, image/jpeg, image/png" onchange="onFileChange(this)"/></p>
</div>

<h2 class="step-two">We'll email your perfectly cropped photo to you in a few minutes when it's ready?</h2>
<div class="step-container step-two">
    <p>Where should we send your photo?</p>
    <p><input id="email" type="text" placeholder="email address"></p>
    <p style="text-align: right;">
        <button onclick="submit();">Submit</button>
    </p>
</div>

<h2 class="step-three">That's it! Check your email for your perfectly cropped passport photo.</h2>
<!--<textarea id="base"></textarea>-->

<!-- END OF UPLOADER -->


</body>
</html>